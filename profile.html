
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Profile - AGIO</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
</head>
<body class="min-h-screen bg-gray-900 text-white">
  <nav class="bg-gray-800/80 backdrop-blur-md py-4 fixed w-full top-0">
    <div class="container mx-auto px-6 flex justify-between items-center">
      <div class="flex items-center space-x-4">
        <img src="logo/logos.png" alt="Logo" class="h-8">
        <span class="text-xl font-bold">AGIO AI</span>
      </div>
      <div class="space-x-4">
        <a href="index.html" class="hover:text-blue-400 transition-colors">Home</a>
        <button 
          onclick="logout()"
          class="px-4 py-2 bg-red-500/90 hover:bg-red-600 rounded-lg transition-colors"
        >
          Logout
        </button>
      </div>
    </div>
  </nav>

  <main class="container mx-auto px-6 pt-24 pb-12 max-w-2xl">
    <div class="gradient-card rounded-xl p-8 shadow-xl">
      <h1 class="text-3xl font-bold mb-8 text-center">User Profile</h1>
      
      <div class="space-y-6">
        <div class="flex items-center space-x-6">
          <img 
            id="profileAvatar"
            src="https://i.ibb.co/3TQ6D7R/agio-logo.png" 
            class="w-32 h-32 rounded-full border-4 border-blue-400/50"
            alt="Profile"
          >
          <div>
            <h2 id="profileName" class="text-2xl font-bold"></h2>
            <p id="profileEmail" class="text-gray-300"></p>
          </div>
        </div>

        <div class="space-y-4">
          <div class="flex justify-between items-center p-4 bg-gray-800/50 rounded-lg">
            <span>Account Type</span>
            <span id="accountType" class="bg-blue-500/20 text-blue-400 px-3 py-1 rounded-full"></span>
          </div>
          
          <div class="flex justify-between items-center p-4 bg-gray-800/50 rounded-lg">
            <span>Last Login</span>
            <span id="lastLogin"></span>
          </div>
          
          <div class="flex justify-between items-center p-4 bg-gray-800/50 rounded-lg">
            <span>Status</span>
            <span id="accountStatus" class="bg-green-500/20 text-green-400 px-3 py-1 rounded-full"></span>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script>
    const firebaseConfig = { /* Same as before */ };
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    const loadProfile = async () => {
      const urlParams = new URLSearchParams(location.search);
      const token = urlParams.get('token');
      const method = urlParams.get('method');

      try {
        if (method === 'github') {
          await auth.signInWithCustomToken(token);
          const user = auth.currentUser;
          
          document.getElementById('profileName').textContent = user.displayName || 'AGIO User';
          document.getElementById('profileEmail').textContent = user.email;
          document.getElementById('accountType').textContent = 'GitHub Account';
          document.getElementById('accountStatus').textContent = user.emailVerified ? 'Verified' : 'Unverified';
          document.getElementById('lastLogin').textContent = new Date(user.metadata.lastSignInTime).toLocaleString();
          
          if(user.photoURL) {
            document.getElementById('profileAvatar').src = user.photoURL;
          }
        } else if (method === 'keyword') {
          const tokenData = JSON.parse(atob(token));
          
          document.getElementById('profileName').textContent = 'Premium Member';
          document.getElementById('profileEmail').textContent = 'Key-based Access';
          document.getElementById('accountType').textContent = 'Secret Key';
          document.getElementById('accountStatus').textContent = 'Active';
          document.getElementById('lastLogin').textContent = new Date(tokenData.timestamp).toLocaleString();
        }
        
        window.history.replaceState({}, '', 'profile.html');
      } catch (error) {
        console.error(error);
        window.location.href = 'https://login-with-agio.web.app';
      }
    };

    const logout = () => {
      auth.signOut();
      window.location.href = 'https://login-with-agio.web.app';
    };

    loadProfile();
  </script>
</body>
</html>
